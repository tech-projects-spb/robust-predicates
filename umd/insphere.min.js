!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";const{epsilon:t,splitter:n,resulterrbound:s,estimate:e,vec:a,sum:r,sum_three:u,scale:o,negate:c}=require("./util.js"),i=(16+224*t)*t,h=(5+72*t)*t,b=(71+1408*t)*t*t,f=a(4),M=a(4),l=a(4),d=a(4),p=a(4),m=a(4),g=a(4),j=a(4),q=a(4),v=a(4),x=a(24),y=a(24),_=a(24),k=a(24),w=a(24),z=a(24),A=a(24),B=a(24),C=a(24),D=a(24),E=a(1152),F=a(1152),G=a(1152),H=a(1152),I=a(1152),J=a(2304),K=a(2304),L=a(3456),N=a(5760),O=a(8),P=a(8),Q=a(8),R=a(16),S=a(24),T=a(48),U=a(48),V=a(96),W=a(192),X=a(384),Y=a(384),Z=a(384),$=a(768);function tt(t,n,s,e,a,r,c){return u(o(4,t,e,O),O,o(4,n,a,P),P,o(4,s,r,Q),Q,R,c)}function nt(t,n,s,e,a,i,h,b,f,M,l,d){const p=r(r(t,n,s,e,T),T,c(r(a,i,h,b,U),U),U,V);return u(o(o(p,V,f,W),W,f,X),X,o(o(p,V,M,W),W,M,Y),Y,o(o(p,V,l,W),W,l,Z),Z,$,d)}const st=a(96),et=a(96),at=a(96),rt=a(1152);function ut(t,n,s,e,a,r,c,i,h,b){const f=tt(t,n,s,e,a,r,S);return u(o(o(f,S,c,T),T,c,st),st,o(o(f,S,i,T),T,i,et),et,o(o(f,S,h,T),T,h,at),at,W,b)}function ot(t,a,o,i,O,P,Q,R,S,T,U,V,W,X,Y,Z){let $,st,et,at,ot,ct,it,ht,bt,ft,Mt,lt,dt,pt,mt,gt,jt,qt,vt,xt,yt,_t,kt,wt,zt,At,Bt,Ct,Dt,Et,Ft;const Gt=t-W,Ht=i-W,It=Q-W,Jt=T-W,Kt=a-X,Lt=O-X,Nt=R-X,Ot=U-X,Pt=o-Y,Qt=P-Y,Rt=S-Y,St=V-Y;Ct=Gt*Lt,xt=n*Gt,yt=xt-(xt-Gt),_t=Gt-yt,xt=n*Lt,kt=xt-(xt-Lt),wt=Lt-kt,Dt=_t*wt-(Ct-yt*kt-_t*kt-yt*wt),Et=Ht*Kt,xt=n*Ht,yt=xt-(xt-Ht),_t=Ht-yt,xt=n*Kt,kt=xt-(xt-Kt),wt=Kt-kt,Ft=_t*wt-(Et-yt*kt-_t*kt-yt*wt),zt=Dt-Ft,vt=Dt-zt,f[0]=Dt-(zt+vt)+(vt-Ft),At=Ct+zt,vt=At-Ct,Bt=Ct-(At-vt)+(zt-vt),zt=Bt-Et,vt=Bt-zt,f[1]=Bt-(zt+vt)+(vt-Et),$=At+zt,vt=$-At,f[2]=At-($-vt)+(zt-vt),f[3]=$,Ct=Ht*Nt,xt=n*Ht,yt=xt-(xt-Ht),_t=Ht-yt,xt=n*Nt,kt=xt-(xt-Nt),wt=Nt-kt,Dt=_t*wt-(Ct-yt*kt-_t*kt-yt*wt),Et=It*Lt,xt=n*It,yt=xt-(xt-It),_t=It-yt,xt=n*Lt,kt=xt-(xt-Lt),wt=Lt-kt,Ft=_t*wt-(Et-yt*kt-_t*kt-yt*wt),zt=Dt-Ft,vt=Dt-zt,M[0]=Dt-(zt+vt)+(vt-Ft),At=Ct+zt,vt=At-Ct,Bt=Ct-(At-vt)+(zt-vt),zt=Bt-Et,vt=Bt-zt,M[1]=Bt-(zt+vt)+(vt-Et),st=At+zt,vt=st-At,M[2]=At-(st-vt)+(zt-vt),M[3]=st,Ct=It*Ot,xt=n*It,yt=xt-(xt-It),_t=It-yt,xt=n*Ot,kt=xt-(xt-Ot),wt=Ot-kt,Dt=_t*wt-(Ct-yt*kt-_t*kt-yt*wt),Et=Jt*Nt,xt=n*Jt,yt=xt-(xt-Jt),_t=Jt-yt,xt=n*Nt,kt=xt-(xt-Nt),wt=Nt-kt,Ft=_t*wt-(Et-yt*kt-_t*kt-yt*wt),zt=Dt-Ft,vt=Dt-zt,l[0]=Dt-(zt+vt)+(vt-Ft),At=Ct+zt,vt=At-Ct,Bt=Ct-(At-vt)+(zt-vt),zt=Bt-Et,vt=Bt-zt,l[1]=Bt-(zt+vt)+(vt-Et),et=At+zt,vt=et-At,l[2]=At-(et-vt)+(zt-vt),l[3]=et,Ct=Jt*Kt,xt=n*Jt,yt=xt-(xt-Jt),_t=Jt-yt,xt=n*Kt,kt=xt-(xt-Kt),wt=Kt-kt,Dt=_t*wt-(Ct-yt*kt-_t*kt-yt*wt),Et=Gt*Ot,xt=n*Gt,yt=xt-(xt-Gt),_t=Gt-yt,xt=n*Ot,kt=xt-(xt-Ot),wt=Ot-kt,Ft=_t*wt-(Et-yt*kt-_t*kt-yt*wt),zt=Dt-Ft,vt=Dt-zt,q[0]=Dt-(zt+vt)+(vt-Ft),At=Ct+zt,vt=At-Ct,Bt=Ct-(At-vt)+(zt-vt),zt=Bt-Et,vt=Bt-zt,q[1]=Bt-(zt+vt)+(vt-Et),at=At+zt,vt=at-At,q[2]=At-(at-vt)+(zt-vt),q[3]=at,Ct=Gt*Nt,xt=n*Gt,yt=xt-(xt-Gt),_t=Gt-yt,xt=n*Nt,kt=xt-(xt-Nt),wt=Nt-kt,Dt=_t*wt-(Ct-yt*kt-_t*kt-yt*wt),Et=It*Kt,xt=n*It,yt=xt-(xt-It),_t=It-yt,xt=n*Kt,kt=xt-(xt-Kt),wt=Kt-kt,Ft=_t*wt-(Et-yt*kt-_t*kt-yt*wt),zt=Dt-Ft,vt=Dt-zt,m[0]=Dt-(zt+vt)+(vt-Ft),At=Ct+zt,vt=At-Ct,Bt=Ct-(At-vt)+(zt-vt),zt=Bt-Et,vt=Bt-zt,m[1]=Bt-(zt+vt)+(vt-Et),ot=At+zt,vt=ot-At,m[2]=At-(ot-vt)+(zt-vt),m[3]=ot,Ct=Ht*Ot,xt=n*Ht,yt=xt-(xt-Ht),_t=Ht-yt,xt=n*Ot,kt=xt-(xt-Ot),wt=Ot-kt,Dt=_t*wt-(Ct-yt*kt-_t*kt-yt*wt),Et=Jt*Lt,xt=n*Jt,yt=xt-(xt-Jt),_t=Jt-yt,xt=n*Lt,kt=xt-(xt-Lt),wt=Lt-kt,Ft=_t*wt-(Et-yt*kt-_t*kt-yt*wt),zt=Dt-Ft,vt=Dt-zt,g[0]=Dt-(zt+vt)+(vt-Ft),At=Ct+zt,vt=At-Ct,Bt=Ct-(At-vt)+(zt-vt),zt=Bt-Et,vt=Bt-zt,g[1]=Bt-(zt+vt)+(vt-Et),ct=At+zt,vt=ct-At,g[2]=At-(ct-vt)+(zt-vt),g[3]=ct;const Tt=r(r(c(ut(M,l,g,St,Qt,-Rt,Gt,Kt,Pt,E),E),E,ut(l,q,m,Pt,Rt,St,Ht,Lt,Qt,F),F,J),J,r(c(ut(q,f,g,Qt,St,Pt,It,Nt,Rt,G),G),G,ut(f,M,m,Rt,Pt,-Qt,Jt,Ot,St,H),H,K),K,rt);let Ut=e(Tt,rt),Vt=h*Z;if(Ut>=Vt||-Ut>=Vt)return Ut;if(vt=t-Gt,it=t-(Gt+vt)+(vt-W),vt=a-Kt,Mt=a-(Kt+vt)+(vt-X),vt=o-Pt,mt=o-(Pt+vt)+(vt-Y),vt=i-Ht,ht=i-(Ht+vt)+(vt-W),vt=O-Lt,lt=O-(Lt+vt)+(vt-X),vt=P-Qt,gt=P-(Qt+vt)+(vt-Y),vt=Q-It,bt=Q-(It+vt)+(vt-W),vt=R-Nt,dt=R-(Nt+vt)+(vt-X),vt=S-Rt,jt=S-(Rt+vt)+(vt-Y),vt=T-Jt,ft=T-(Jt+vt)+(vt-W),vt=U-Ot,pt=U-(Ot+vt)+(vt-X),vt=V-St,qt=V-(St+vt)+(vt-Y),0===it&&0===Mt&&0===mt&&0===ht&&0===lt&&0===gt&&0===bt&&0===dt&&0===jt&&0===ft&&0===pt&&0===qt)return Ut;Vt=b*Z+s*Math.abs(Ut);const Wt=Gt*lt+Lt*it-(Kt*ht+Ht*Mt),Xt=Ht*dt+Nt*ht-(Lt*bt+It*lt),Yt=It*pt+Ot*bt-(Nt*ft+Jt*dt),Zt=Jt*Mt+Kt*ft-(Ot*it+Gt*pt),$t=Gt*dt+Nt*it-(Kt*bt+It*Mt),tn=Ht*pt+Ot*ht-(Lt*ft+Jt*lt);return Ut+=(Ht*Ht+Lt*Lt+Qt*Qt)*(Rt*Zt+St*$t+Pt*Yt+(jt*at+qt*ot+mt*et))+(Jt*Jt+Ot*Ot+St*St)*(Pt*Xt-Qt*$t+Rt*Wt+(mt*st-gt*ot+jt*$))-((Gt*Gt+Kt*Kt+Pt*Pt)*(Qt*Yt-Rt*tn+St*Xt+(gt*et-jt*ct+qt*st))+(It*It+Nt*Nt+Rt*Rt)*(St*Wt+Pt*tn+Qt*Zt+(qt*$+mt*ct+gt*at)))+2*((Ht*ht+Lt*lt+Qt*gt)*(Rt*at+St*ot+Pt*et)+(Jt*ft+Ot*pt+St*qt)*(Pt*st-Qt*ot+Rt*$)-((Gt*it+Kt*Mt+Pt*mt)*(Qt*et-Rt*ct+St*st)+(It*bt+Nt*dt+Rt*jt)*(St*$+Pt*ct+Qt*at))),Ut>=Vt||-Ut>=Vt?Ut:function(t,s,e,a,r,o,c,i,h,b,O,P,Q,R,S){let T,U,V,W,X,Y,Z,$,st,et,at,rt,ut,ot;et=t*r,U=n*t,V=U-(U-t),W=t-V,U=n*r,X=U-(U-r),Y=r-X,at=W*Y-(et-V*X-W*X-V*Y),rt=a*s,U=n*a,V=U-(U-a),W=a-V,U=n*s,X=U-(U-s),Y=s-X,ut=W*Y-(rt-V*X-W*X-V*Y),Z=at-ut,T=at-Z,f[0]=at-(Z+T)+(T-ut),$=et+Z,T=$-et,st=et-($-T)+(Z-T),Z=st-rt,T=st-Z,f[1]=st-(Z+T)+(T-rt),ot=$+Z,T=ot-$,f[2]=$-(ot-T)+(Z-T),f[3]=ot,et=a*i,U=n*a,V=U-(U-a),W=a-V,U=n*i,X=U-(U-i),Y=i-X,at=W*Y-(et-V*X-W*X-V*Y),rt=c*r,U=n*c,V=U-(U-c),W=c-V,U=n*r,X=U-(U-r),Y=r-X,ut=W*Y-(rt-V*X-W*X-V*Y),Z=at-ut,T=at-Z,M[0]=at-(Z+T)+(T-ut),$=et+Z,T=$-et,st=et-($-T)+(Z-T),Z=st-rt,T=st-Z,M[1]=st-(Z+T)+(T-rt),ot=$+Z,T=ot-$,M[2]=$-(ot-T)+(Z-T),M[3]=ot,et=c*O,U=n*c,V=U-(U-c),W=c-V,U=n*O,X=U-(U-O),Y=O-X,at=W*Y-(et-V*X-W*X-V*Y),rt=b*i,U=n*b,V=U-(U-b),W=b-V,U=n*i,X=U-(U-i),Y=i-X,ut=W*Y-(rt-V*X-W*X-V*Y),Z=at-ut,T=at-Z,l[0]=at-(Z+T)+(T-ut),$=et+Z,T=$-et,st=et-($-T)+(Z-T),Z=st-rt,T=st-Z,l[1]=st-(Z+T)+(T-rt),ot=$+Z,T=ot-$,l[2]=$-(ot-T)+(Z-T),l[3]=ot,et=b*R,U=n*b,V=U-(U-b),W=b-V,U=n*R,X=U-(U-R),Y=R-X,at=W*Y-(et-V*X-W*X-V*Y),rt=Q*O,U=n*Q,V=U-(U-Q),W=Q-V,U=n*O,X=U-(U-O),Y=O-X,ut=W*Y-(rt-V*X-W*X-V*Y),Z=at-ut,T=at-Z,d[0]=at-(Z+T)+(T-ut),$=et+Z,T=$-et,st=et-($-T)+(Z-T),Z=st-rt,T=st-Z,d[1]=st-(Z+T)+(T-rt),ot=$+Z,T=ot-$,d[2]=$-(ot-T)+(Z-T),d[3]=ot,et=Q*s,U=n*Q,V=U-(U-Q),W=Q-V,U=n*s,X=U-(U-s),Y=s-X,at=W*Y-(et-V*X-W*X-V*Y),rt=t*R,U=n*t,V=U-(U-t),W=t-V,U=n*R,X=U-(U-R),Y=R-X,ut=W*Y-(rt-V*X-W*X-V*Y),Z=at-ut,T=at-Z,p[0]=at-(Z+T)+(T-ut),$=et+Z,T=$-et,st=et-($-T)+(Z-T),Z=st-rt,T=st-Z,p[1]=st-(Z+T)+(T-rt),ot=$+Z,T=ot-$,p[2]=$-(ot-T)+(Z-T),p[3]=ot,et=t*i,U=n*t,V=U-(U-t),W=t-V,U=n*i,X=U-(U-i),Y=i-X,at=W*Y-(et-V*X-W*X-V*Y),rt=c*s,U=n*c,V=U-(U-c),W=c-V,U=n*s,X=U-(U-s),Y=s-X,ut=W*Y-(rt-V*X-W*X-V*Y),Z=at-ut,T=at-Z,m[0]=at-(Z+T)+(T-ut),$=et+Z,T=$-et,st=et-($-T)+(Z-T),Z=st-rt,T=st-Z,m[1]=st-(Z+T)+(T-rt),ot=$+Z,T=ot-$,m[2]=$-(ot-T)+(Z-T),m[3]=ot,et=a*O,U=n*a,V=U-(U-a),W=a-V,U=n*O,X=U-(U-O),Y=O-X,at=W*Y-(et-V*X-W*X-V*Y),rt=b*r,U=n*b,V=U-(U-b),W=b-V,U=n*r,X=U-(U-r),Y=r-X,ut=W*Y-(rt-V*X-W*X-V*Y),Z=at-ut,T=at-Z,g[0]=at-(Z+T)+(T-ut),$=et+Z,T=$-et,st=et-($-T)+(Z-T),Z=st-rt,T=st-Z,g[1]=st-(Z+T)+(T-rt),ot=$+Z,T=ot-$,g[2]=$-(ot-T)+(Z-T),g[3]=ot,et=c*R,U=n*c,V=U-(U-c),W=c-V,U=n*R,X=U-(U-R),Y=R-X,at=W*Y-(et-V*X-W*X-V*Y),rt=Q*i,U=n*Q,V=U-(U-Q),W=Q-V,U=n*i,X=U-(U-i),Y=i-X,ut=W*Y-(rt-V*X-W*X-V*Y),Z=at-ut,T=at-Z,j[0]=at-(Z+T)+(T-ut),$=et+Z,T=$-et,st=et-($-T)+(Z-T),Z=st-rt,T=st-Z,j[1]=st-(Z+T)+(T-rt),ot=$+Z,T=ot-$,j[2]=$-(ot-T)+(Z-T),j[3]=ot,et=b*s,U=n*b,V=U-(U-b),W=b-V,U=n*s,X=U-(U-s),Y=s-X,at=W*Y-(et-V*X-W*X-V*Y),rt=t*O,U=n*t,V=U-(U-t),W=t-V,U=n*O,X=U-(U-O),Y=O-X,ut=W*Y-(rt-V*X-W*X-V*Y),Z=at-ut,T=at-Z,q[0]=at-(Z+T)+(T-ut),$=et+Z,T=$-et,st=et-($-T)+(Z-T),Z=st-rt,T=st-Z,q[1]=st-(Z+T)+(T-rt),ot=$+Z,T=ot-$,q[2]=$-(ot-T)+(Z-T),q[3]=ot,et=Q*r,U=n*Q,V=U-(U-Q),W=Q-V,U=n*r,X=U-(U-r),Y=r-X,at=W*Y-(et-V*X-W*X-V*Y),rt=a*R,U=n*a,V=U-(U-a),W=a-V,U=n*R,X=U-(U-R),Y=R-X,ut=W*Y-(rt-V*X-W*X-V*Y),Z=at-ut,T=at-Z,v[0]=at-(Z+T)+(T-ut),$=et+Z,T=$-et,st=et-($-T)+(Z-T),Z=st-rt,T=st-Z,v[1]=st-(Z+T)+(T-rt),ot=$+Z,T=ot-$,v[2]=$-(ot-T)+(Z-T),v[3]=ot;const ct=tt(f,M,m,h,e,-o,x),it=tt(M,l,g,P,o,-h,y),ht=tt(l,d,j,S,h,-P,_),bt=tt(d,p,q,e,P,-S,k),ft=tt(p,f,v,o,S,-e,w),Mt=tt(f,g,q,P,e,o,z),lt=tt(M,j,v,S,o,h,A),dt=tt(l,q,m,e,h,P,B),pt=tt(d,v,g,o,P,S,C),mt=tt(p,m,j,h,S,e,D),gt=u(nt(ht,_,lt,A,pt,C,it,y,t,s,e,E),E,nt(bt,k,dt,B,mt,D,ht,_,a,r,o,F),F,u(nt(ft,w,pt,C,Mt,z,bt,k,c,i,h,G),G,nt(ct,x,mt,D,lt,A,ft,w,b,O,P,H),H,nt(it,y,Mt,z,dt,B,ct,x,Q,R,S,I),I,K,L),L,J,N);return N[gt-1]}(t,a,o,i,O,P,Q,R,S,T,U,V,W,X,Y)}module.exports={insphere:function(t,n,s,e,a,r,u,o,c,h,b,f,M,l,d){const p=t-M,m=e-M,g=u-M,j=h-M,q=n-l,v=a-l,x=o-l,y=b-l,_=s-d,k=r-d,w=c-d,z=f-d,A=p*v,B=m*q,C=A-B,D=m*x,E=g*v,F=D-E,G=g*y,H=j*x,I=G-H,J=j*q,K=p*y,L=J-K,N=p*x,O=g*q,P=N-O,Q=m*y,R=j*v,S=Q-R,T=p*p+q*q+_*_,U=m*m+v*v+k*k,V=g*g+x*x+w*w,W=j*j+y*y+z*z,X=V*(z*C+_*S+k*L)-W*(_*F-k*P+w*C)+(T*(k*I-w*S+z*F)-U*(w*L+z*P+_*I)),Y=Math.abs(_),Z=Math.abs(k),$=Math.abs(w),tt=Math.abs(z),nt=Math.abs(A)+Math.abs(B),st=Math.abs(D)+Math.abs(E),et=Math.abs(G)+Math.abs(H),at=Math.abs(J)+Math.abs(K),rt=Math.abs(N)+Math.abs(O),ut=Math.abs(Q)+Math.abs(R),ct=(et*Z+ut*$+st*tt)*T+(at*$+rt*tt+et*Y)*U+(nt*tt+ut*Y+at*Z)*V+(st*Y+rt*Z+nt*$)*W,it=i*ct;return X>it||-X>it?X:-ot(t,n,s,e,a,r,u,o,c,h,b,f,M,l,d,ct)},inspherefast:function(t,n,s,e,a,r,u,o,c,i,h,b,f,M,l){const d=t-f,p=e-f,m=u-f,g=i-f,j=n-M,q=a-M,v=o-M,x=h-M,y=s-l,_=r-l,k=c-l,w=b-l,z=d*q-p*j,A=p*v-m*q,B=m*x-g*v,C=g*j-d*x,D=d*v-m*j,E=p*x-g*q;return(m*m+v*v+k*k)*(w*z+y*E+_*C)-(g*g+x*x+w*w)*(y*A-_*D+k*z)+((d*d+j*j+y*y)*(_*B-k*E+w*A)-(p*p+q*q+_*_)*(k*C+w*D+y*B))}}}));
